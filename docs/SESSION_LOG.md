# Session Log

## 2026-02-12
Fixed terminal proxy body consumption bug and reverted to SSE pass-through (matching chat route) after discovering await res.text() hangs on open streams. Added AuthGuard with localStorage validation flag so clearing browser cache forces re-login. Extracted LogoutButton component and added it to all browse pages and project workspace. Added /api/terminal/test diagnostic endpoint and verbose logging throughout proxy and cc-server terminal route. Fixed Start CC Server.command to auto-kill stale port 3002 processes and auto-restart on crash. Fixed terminal kill bug — `req.on("close")` fires when Express finishes consuming the POST body, not on client disconnect; changed to `res.on("close")`. Moved cc-server from port 3002 to 3020 to avoid conflicts with Next.js dev server. Added Chat tab to project workspace (was only accessible via direct URL). Added back button to browse pages and home button to project workspace header for mobile navigation. Added local-only server launcher (`Start CC Server Local.command`).

## 2026-02-11
Built full CC Interface project: Express server (cc-server) with auth middleware, file browsing, and Claude Agent SDK chat streaming on port 3002; Next.js frontend with file browser, file viewer, chat interface, and NextAuth Google OAuth setup. Restructured project — moved Next.js app to repo root for Vercel, cc-server stays as subfolder. Fixed Vercel build (excluded cc-server from tsconfig/eslint). Deployed to Vercel (claudemobile-sigma.vercel.app), bought claudemobile.dev domain, created Cloudflare Tunnel (api.claudemobile.dev -> localhost:3002). Added terminal backend route (SSE streaming bash commands) and tabbed project workspace (/project/[project]) with Browse, Terminal, and File tabs using CSS hidden for state persistence. Downgraded Next.js 16 to 15.5.12 — v16 deprecated middleware.ts convention which broke Google auth entirely. Fixed terminal proxy — reverted from broken JSON buffering (await res.text() hangs on SSE) to SSE pass-through matching chat route; added 10s timeout to serverFetch for fast cc-server-down errors. Fixed auth cache-clear logout via localStorage validation flag (AuthGuard) — clearing browser cache now forces re-login. Added LogoutButton component to all pages (browse root, subfolders, project workspace). Updated Start CC Server.command with auto-restart loop. Next: restart cc-server on iMac and verify terminal works end-to-end.
